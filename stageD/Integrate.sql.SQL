ALTER TABLE DISHS RENAME COLUMN NAME TO DESCRIPTION;
ALTER TABLE MEAL1 ADD (COSHERTYPE VARCHAR2(7));
CREATE OR REPLACE FUNCTION random_kosher_type RETURN VARCHAR2 IS
BEGIN
  -- �������� ������ ��� ������� ��� 1 �-3
  RETURN CASE TRUNC(DBMS_RANDOM.VALUE(1, 4))
    WHEN 1 THEN 'None'
    WHEN 2 THEN 'Meat'
    WHEN 3 THEN 'Dairy'
  END;
END;
/
UPDATE MEAL1 SET COSHERTYPE = random_kosher_type();
ALTER TABLE MEAL1 ADD (CATERING_ID NUMBER(5));

CREATE OR REPLACE FUNCTION random_catering_id RETURN NUMBER AS
  v_catering_id CATERING.CATERING_ID%TYPE;
BEGIN
  SELECT CATERING_ID INTO v_catering_id FROM (
    SELECT CATERING_ID FROM CATERING ORDER BY DBMS_RANDOM.VALUE
  ) WHERE ROWNUM = 1;

  RETURN v_catering_id;
END;
/
UPDATE MEAL1 SET CATERING_ID = random_catering_id();
ALTER TABLE MEAL1 DROP COLUMN DAY;

ALTER TABLE MEAL1 ADD (PRICE NUMBER(4));
UPDATE MEAL1
SET PRICE = TRUNC(DBMS_RANDOM.VALUE(20, 201));



-- ����� �������
INSERT INTO DISHS (DISHS_ID, PRICE, DESCRIPTION, COSHERTYPE, CATERING_ID)
SELECT MEAL_ID, TO_NUMBER(PRICE), DESCRIPTION, COSHERTYPE, CATERING_ID
FROM MEAL1;

DROP TABLE Meal1;

-- ����� ��� ���� �� �� ����
ALTER TABLE KINDERGARTEN_TEACHER ADD (kteacher_id_temp NUMBER(15));
UPDATE KINDERGARTEN_TEACHER SET kteacher_id_temp = TO_NUMBER(kteacher_id);
ALTER TABLE KINDERGARTEN_TEACHER DROP COLUMN kteacher_id;
ALTER TABLE KINDERGARTEN_TEACHER RENAME COLUMN kteacher_id_temp TO kteacher_id;
ALTER TABLE KINDERGARTEN_TEACHER ADD CONSTRAINT PK_KINDERGARTEN_TEACHER PRIMARY KEY (kteacher_id);

-- ����� ��� ��� �� �� ���� ����� ������
ALTER TABLE groups1 ADD (customer_id_temp NUMBER(15));
UPDATE groups1 SET customer_id_temp = TO_NUMBER(customer_id);
ALTER TABLE groups1 DROP COLUMN customer_id;
ALTER TABLE groups1 RENAME COLUMN customer_id_temp TO customer_id;


-- ���� ����� ��� �����
ALTER TABLE GROUPS1 DROP CONSTRAINT SYS_C007468;

-- ����� ����� ������ ����� GROUPS
ALTER TABLE GROUPS1 RENAME COLUMN kteacher_id TO customer_id;

-- ����� ���� �� ��� ����� �� CUSTOMER �-GROUPS
ALTER TABLE GROUPS1 ADD CONSTRAINT fk_customer_id FOREIGN KEY (customer_id)
REFERENCES CUSTOMER (customer_id);

-- ����� ����� ��� �������
SELECT customer_id FROM groups1
WHERE customer_id NOT IN (SELECT customer_id FROM CUSTOMER);

DELETE FROM GROUPS1
WHERE customer_id NOT IN (SELECT customer_id FROM CUSTOMER);


-- ���� ����� �����
ALTER TABLE KINDERGARTEN_TEACHER DROP CONSTRAINT PK_KINDERGARTEN_TEACHER;

ALTER TABLE KINDERGARTEN_TEACHER MODIFY (kteacher_id NUMBER(15));

-- ����� ����� ����� ����
ALTER TABLE KINDERGARTEN_TEACHER ADD CONSTRAINT PK_KINDERGARTEN_TEACHER PRIMARY KEY (kteacher_id);


--����� ���� �����
ALTER TABLE GROUPS1 RENAME COLUMN customer_id TO kindergarten_teacher_id;
ALTER TABLE CUSTOMER DROP COLUMN EMAIL;
ALTER TABLE KINDERGARTEN_TEACHER DROP COLUMN last_name;
ALTER TABLE KINDERGARTEN_TEACHER RENAME COLUMN first_name TO name;
ALTER TABLE CUSTOMER DROP COLUMN ADDRESS;
ALTER TABLE KINDERGARTEN_TEACHER
ADD (payment_details VARCHAR2(100) DEFAULT 'Bit' NOT NULL);

--����� �������
INSERT INTO CUSTOMER (CUSTOMER_ID, NAME, PHONENUMBER, PAYMENTDETAILS)
SELECT KTEACHER_ID, NAME, PHONE_NUMBER, PAYMENT_DETAILS
FROM KINDERGARTEN_TEACHER;

DROP TABLE Kindergarten_Teacher;

Select * from Kindergarten_Teacher; 
Select count(*) from Kindergarten_Teacher;

Select * from customer; 
Select count(*) from customer;

